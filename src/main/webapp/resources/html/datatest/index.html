<!DOCTYPE html>
<html lang="en" ng-app="testApp" ng-controller="fontInit">
<head>
    <meta charset="UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <meta name="keywords" content="CrapApi,api,crap,接口管理,应用接口管理,开源接口管理,开源api接口管理,api接口管理"/>
    <meta name="description" content="免费开源的API接口管理系统、文档管理系统。系统特点：极致简单、开源开放、技术前沿。主要功能有：接口管理、接口调试、文档管理、数据字典管理、文章管理....。"/>
    <link href="{{settings.ICON}}" rel="shortcut icon" type="image/x-icon"/>
    <link href="{{settings.ICON}}" rel="icon" type="image/x-icon"/>
    <link href="{{settings.ICON}}" rel="shortcut" type="image/x-icon"/>
    <link href="resources/framework/bootstrap-3.0.0/css/bootstrap.css" rel="stylesheet" type="text/css"/>
    <link href="resources/framework/bootstrap-3.0.0/css/bootstrap-datetimepicker.min.css" rel="stylesheet"
          type="text/css"/>
    <!-- base-min.css,admin.css应该发在bootstrap之后,覆盖部分bootstrap样式 -->
    <link href="resources/css/base.css" rel="stylesheet" type="text/css"/>
    <link href="resources/css/crapApi.css" rel="stylesheet" type="text/css"/>
    <link href="resources/framework/font-awesome-4.5.0/css/font-awesome.min.css" rel="stylesheet" type="text/css"/>
    <link href="resources/framework/textAngular-1.5.0/textAngular.css" rel="stylesheet" type="text/css"/>
    <link rel="stylesheet" href="resources/css/zTreeStyle/zTreeStyle.css" type="text/css">
    <link rel="stylesheet" href="resources/css/jsoneditor/dist/jsoneditor.min.css" type="text/css">
    <title ng-bind="settings.TITLE">Api接口管理系统</title>
    <style>
        .add {
            background-position: -144px 0;
        }
    </style>
</head>
<body class="BG_COLOR">
<div ng-include="'resources/html/subTpl/css.tpl.html'"></div>
<!-- Top Nav -->
<div ng-include="'resources/html/subTpl/frontTopNav.tpl.html'"></div>
<!-- Top Nav End -->

<!-- Top Search-->
<div class="mb20">
</div>
<!-- Top Search End-->

<div class="container p0">
    <div class="row min-h p0 m0">


        <!-- leftMenu -->
        <div class="col-xs-4 col-sm-4 sidebar BGEEE p20 pt0 pb0 m0 min-h600">
            <div>
                <ul id="treeDemo" class="ztree"></ul>
            </div>
        </div>
        <!-- End:leftMenu -->


        <div class="col-xs-8 col-sm-8 p0 BG_COLOR m0 p10 pt0 r5">
            <div ng-controller="jsonController">
                <div ng-jsoneditor ng-model="obj.data" options="obj.options" style="height: 500px;">

                </div>
            </div>
        </div>
    </div>
</div>


<script src="resources/framework/jquery-1.9.1.min.js"></script>
<script src="resources/framework/jquery.cookie.js"></script>
<script src="resources/framework/jquery.base64.js"></script>

<script src="resources/framework/angular-1.3.0.14/angular.js"></script>
<script src="resources/framework/angular-1.3.0.14/angular-animate.min.js"></script>
<script src="resources/framework/angular-ui-router-0.2.15.js"></script>
<script src="resources/js/app.js?v=2010"></script>
<script src="resources/js/services.js"></script>
<script src="resources/js/frontRouter.js"></script>
<script src="resources/js/router.js"></script>
<script src="resources/js/backControllers.js?v=2010"></script>
<script src="resources/js/frontControllers.js?v=2010"></script>

<script
        src='resources/framework/textAngular-1.5.0/textAngular-rangy.min.js'></script>
<script
        src='resources/framework/textAngular-1.5.0/textAngular-sanitize.min.js'></script>
<script src='resources/framework/textAngular-1.5.0/textAngular.min.js'></script>
<script src="resources/framework/bootstrap-3.0.0/js/bootstrap.js"></script>
<script
        src="resources/framework/bootstrap-3.0.0/js/bootstrap-datetimepicker.min.js"></script>
<script
        src="resources/framework/bootstrap-3.0.0/js/bootstrap-datetimepicker.zh-CN.js"></script>
<script src="resources/js/validateAndRefresh.js?v=200"></script>
<script src="resources/js/core.js?v=200"></script>
<script src="resources/js/global.js?v=200"></script>
<script src="resources/js/crapApi.js?v=200"></script>
<script type="text/javascript" src="resources/framework/jquery.ztree.all.min.js"></script>
<script type="text/javascript" src="resources/framework/jsoneditor/jsoneditor.min.js"></script>
<script type="text/javascript" src="resources/framework/jsoneditor/ng-jsoneditor.min.js"></script>

<SCRIPT LANGUAGE="JavaScript">
    jsonschema = {
        "$schema": "http://json-schema.org/draft-04/schema#",
        "title": "Product",
        "description": "A product from Acme's catalog",
        "type": "object",
        "properties": {
            "id": {
                "description": "The unique identifier for a product",
                "type": "integer"
            },
            "name": {
                "description": "Name of the product",
                "type": "string"
            },
            "price": {
                "type": "number",
                "minimum": 0,
                "exclusiveMinimum": true
            }
        },
        "required": ["id", "name", "price"]
    }
    var jsonApp = angular.module('testApp', ['app', 'ng.jsoneditor']);
    jsonApp.controller('jsonController', ['$scope', function ($scope) {
        $scope.obj = {data: '{}', options: {mode: 'code', schema: jsonschema}}
        $scope.btnClick = function () {
            $scope.obj.options.mode = 'code'
        }
    }])
</SCRIPT>
<SCRIPT type="text/javascript">
    <!--
    var setting = {
        view: {
            addHoverDom: addHoverDom,
            removeHoverDom: removeHoverDom,
        },
        edit: {
            enable: true,
            editNameSelectAll: true,
            showRemoveBtn: true,
            showRenameBtn: true
        },
        data: {
            simpleData: {
                enable: true
            }
        },
        callback: {
            beforeEditName: beforeEditName,
            beforeRemove: beforeRemove,
            beforeRename: beforeRename,
            onRemove: onRemove,
            onRename: onRename
        }
    };

    var zNodes = [
        {id: 1, pId: 0, name: "父节点 1", open: true},
        {id: 11, pId: 1, name: "叶子节点 1-1"},
        {id: 12, pId: 1, name: "叶子节点 1-2"},
        {id: 13, pId: 1, name: "叶子节点 1-3"},
        {id: 2, pId: 0, name: "父节点 2", open: true},
        {id: 21, pId: 2, name: "叶子节点 2-1"},
        {id: 22, pId: 2, name: "叶子节点 2-2"},
        {id: 23, pId: 2, name: "叶子节点 2-3"},
        {id: 3, pId: 0, name: "父节点 3", open: true},
        {id: 31, pId: 3, name: "叶子节点 3-1"},
        {id: 32, pId: 3, name: "叶子节点 3-2"},
        {id: 33, pId: 3, name: "叶子节点 3-3"}
    ];
    var log, className = "dark";
    function beforeEditName(treeId, treeNode) {
        className = (className === "dark" ? "" : "dark");
        showLog("[ " + getTime() + " beforeEditName ]&nbsp;&nbsp;&nbsp;&nbsp; " + treeNode.name);
        var zTree = $.fn.zTree.getZTreeObj("treeDemo");
        zTree.selectNode(treeNode);
        return confirm("进入节点 -- " + treeNode.name + " 的编辑状态吗？");
    }
    function beforeRemove(treeId, treeNode) {
        className = (className === "dark" ? "" : "dark");
        showLog("[ " + getTime() + " beforeRemove ]&nbsp;&nbsp;&nbsp;&nbsp; " + treeNode.name);
        var zTree = $.fn.zTree.getZTreeObj("treeDemo");
        zTree.selectNode(treeNode);
        return confirm("确认删除 节点 -- " + treeNode.name + " 吗？");
    }
    function onRemove(e, treeId, treeNode) {
        showLog("[ " + getTime() + " onRemove ]&nbsp;&nbsp;&nbsp;&nbsp; " + treeNode.name);
    }
    function beforeRename(treeId, treeNode, newName, isCancel) {
        className = (className === "dark" ? "" : "dark");
        showLog((isCancel ? "<span style='color:red'>" : "") + "[ " + getTime() + " beforeRename ]&nbsp;&nbsp;&nbsp;&nbsp; " + treeNode.name + (isCancel ? "</span>" : ""));
        if (newName.length == 0) {
            alert("节点名称不能为空.");
            var zTree = $.fn.zTree.getZTreeObj("treeDemo");
            setTimeout(function () {
                zTree.editName(treeNode)
            }, 10);
            return false;
        }
        return true;
    }
    function onRename(e, treeId, treeNode, isCancel) {
        showLog((isCancel ? "<span style='color:red'>" : "") + "[ " + getTime() + " onRename ]&nbsp;&nbsp;&nbsp;&nbsp; " + treeNode.name + (isCancel ? "</span>" : ""));
    }

    var newCount = 1;
    function addHoverDom(treeId, treeNode) {
        var sObj = $("#" + treeNode.tId + "_span");
        if (treeNode.editNameFlag || $("#addBtn_" + treeNode.tId).length > 0) return;
        var addStr = "<span class='button add' id='addBtn_" + treeNode.tId
                + "' title='add node' onfocus='this.blur();'></span>";
        sObj.after(addStr);
        var btn = $("#addBtn_" + treeNode.tId);
        if (btn) btn.bind("click", function () {
            var zTree = $.fn.zTree.getZTreeObj("treeDemo");
            zTree.addNodes(treeNode, {id: (100 + newCount), pId: treeNode.id, name: "new node" + (newCount++)});
            return false;
        });
    }
    ;
    function removeHoverDom(treeId, treeNode) {
        $("#addBtn_" + treeNode.tId).unbind().remove();
    }
    ;

    $(document).ready(function () {
        $.fn.zTree.init($("#treeDemo"), setting, zNodes);
    });
    //-->
</SCRIPT>
</body>
</html>
